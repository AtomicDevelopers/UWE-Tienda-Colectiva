@startuml guest_user_process_model
allow_mixing

skinparam shadow false
skinparam packageStyle rectangle
skinparam roundCorner 15
skinparam class {
  BackgroundColor #FEFECE
  BorderColor #A80036
  ArrowColor #A80036
}

' ==========================================
' MODELO DE PROCESO (UWE) - ESTRUCTURA
' ==========================================
' Este diagrama describe la estructura estática de los procesos, incluyendo 
' clases de entrada de datos, validación y ventanas de confirmación.

package "Procesamiento de Usuario Invitado" {

  ' --- Clases Base ---
  package "Base" {
    class "Confirmacion" as Confirmation <<processClass>> {
      - pregunta : String
    }
    
    class "ErrorValidacion" as ValidationError <<processClass>> {
      - mensaje : String
    }

    ' Una clase base abstracta para el procesamiento común
    class "ProcesamientoInvitado" as GuestProcessing <<processClass>> {
      ' Lógica común
    }
  }


  ' ==========================================
  ' 1. PROCESO DE REGISTRO
  ' ==========================================
  package "Proceso de Registro" {
    class "DatosEntradaRegistro" as RegisterInput <<processClass>> {
      - nombre : String
      - email : String
      - celular : String
      - password : String
      - validarDatos()
    }
    
    class "ProcesoRegistro" as RegisterProcess <<processClass>>
    
    class "ConfirmacionRegistro" as RegisterConfirm <<processClass>> {
      - guardarUsuario()
    }
    
    ' Relaciones
    RegisterProcess -up-|> GuestProcessing
    RegisterProcess *-- RegisterInput
    RegisterInput *-- ValidationError
    RegisterConfirm -up-|> Confirmation
    RegisterProcess ..> RegisterConfirm : result
  }


  ' ==========================================
  ' 2. PROCESO DE LOGIN
  ' ==========================================
  package "Proceso de Login" {
    class "DatosEntradaLogin" as LoginInput <<processClass>> {
      - email : String
      - password : String
      - validarCredenciales()
    }
    
    class "ProcesoLogin" as LoginProcess <<processClass>>
    
    class "ConfirmacionLogin" as LoginConfirm <<processClass>> {
      - iniciarSesion()
    }
    
    ' Relaciones
    LoginProcess -up-|> GuestProcessing
    LoginProcess *-- LoginInput
    LoginInput *-- ValidationError
    LoginConfirm -up-|> Confirmation
    LoginProcess ..> LoginConfirm : result
  }
  
  
  ' ==========================================
  ' 3. PROCESAMIENTO DE INTERESES
  ' ==========================================
  package "Gestión de Intereses" {
    ' Guardar Interés
    class "DatosEntradaInteres" as InterestInput <<processClass>> {
      - productoId : UUID
      - fecha : DateTime
    }
    
    class "ProcesoGuardarInteres" as SaveInterestProcess <<processClass>>
    class "ConfirmacionGuardado" as SaveConfirm <<processClass>>

    SaveInterestProcess -up-|> GuestProcessing
    SaveInterestProcess *-- InterestInput
    SaveInterestProcess ..> SaveConfirm : result

    ' Eliminar Interés
    class "EliminarInteres" as InterestDelete <<processClass>>
    class "ConfirmacionEliminacion" as DeleteConfirm <<processClass>>
    
    InterestDelete ..> DeleteConfirm : result
    DeleteConfirm -up-|> Confirmation
  }


  ' ==========================================
  ' 4. GESTIÓN DE UBICACIÓN
  ' ==========================================
  package "Gestión de Ubicación" {
    class "DatosEntradaUbicacion" as LocationInput <<processClass>> {
      - direccion : String
      - coordenadas : String
      - validarUbicacion()
    }

    class "ProcesoUbicacion" as LocationProcess <<processClass>>
    class "ConfirmacionUbicacion" as LocationConfirm <<processClass>>

    LocationProcess -up-|> GuestProcessing
    LocationProcess *-- LocationInput
    LocationProcess ..> LocationConfirm : result
  }


  ' ==========================================
  ' 5. RECUPERACIÓN DE CONTRASEÑA
  ' ==========================================
  package "Recuperación de Contraseña" {
    class "DatosEntradaRecuperacion" as RecoveryInput <<processClass>> {
      - email : String
    }

    class "ProcesoRecuperacion" as RecoveryProcess <<processClass>>
    class "ConfirmacionEnvioRecuperacion" as RecoveryConfirm <<processClass>>

    RecoveryProcess -up-|> GuestProcessing
    RecoveryProcess *-- RecoveryInput
    RecoveryProcess ..> RecoveryConfirm : result
  }

}

@enduml
